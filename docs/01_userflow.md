# 사용자 흐름 케이스 (User Flow Cases)

## 목차

- [1. 인증 관련 흐름](#1-인증-관련-흐름)
- [2. 네비게이션(GNB/LNB) 흐름](#2-네비게이션gnblnb-흐름)
- [3. 대시보드 (/) 흐름](#3-대시보드--흐름)
- [4. 할 일 목록 (/task) 흐름](#4-할-일-목록-task-흐름)
- [5. 할 일 상세 (/task/:id) 흐름](#5-할-일-상세-taskid-흐름)
- [6. 회원정보 페이지 흐름](#6-회원정보-페이지-흐름)
- [7. 에지 케이스 및 예외 흐름](#7-에지-케이스-및-예외-흐름)
- [8. 흐름 다이어그램](#8-흐름-다이어그램)
- [9. 테스트 체크리스트](#9-테스트-체크리스트)

---

## 문서 범례

| 구분 | 설명 |
|:-----|:-----|
| ✅ **필수** | 명세에 명시된 필수 구현 항목 |
| ⚠️ **선택** | 명세에 직접 명시되지 않았으나 UX 보완으로 허용되는 항목 |
| 💡 **설계 결정** | 명세에 명시되지 않아 자의적으로 결정한 항목 |

``` markdown
- 인증 상태: 전역 상태
- 페이지 데이터: 서버 상태
- 모달/입력값: 로컬 상태
```

---

## 1. 인증 관련 흐름

### 1.1 로그인 흐름 ✅ 필수

| 케이스 | 시작 상태 | 사용자 행동 | 예상 결과 |
|:-------|:----------|:------------|:----------|
| 정상 로그인 | 비로그인 | 유효한 이메일/비밀번호 입력 → 제출 | 대시보드로 이동, 토큰 저장 |
| 이메일 형식 오류 | 비로그인 | 잘못된 이메일 형식 입력 | 에러 메시지 표시, 제출 버튼 비활성화 |
| 비밀번호 길이 부족 | 비로그인 | 8자 미만 비밀번호 입력 | 에러 메시지 표시, 제출 버튼 비활성화 |
| 비밀번호 길이 초과 | 비로그인 | 24자 초과 비밀번호 입력 | 에러 메시지 표시, 제출 버튼 비활성화 |
| 비밀번호 문자 규칙 위반 | 비로그인 | 영문/한글/숫자 외 문자 입력 | 에러 메시지 표시, 제출 버튼 비활성화 |
| 필수값 미입력 | 비로그인 | 이메일 또는 비밀번호 비움 | 제출 버튼 비활성화 |
| 서버 에러 (400) | 비로그인 | 유효한 폼 제출 → 서버 거부 | 에러 모달 표시 (errorMessage) |
| **이미 로그인된 상태** ✅ | 로그인됨 | `/sign-in` 직접 접근 | 대시보드(`/`)로 자동 리다이렉트 |

### 1.2 인증 상태 관리 ✅ 필수

> 💡 **설계 결정**: 원본 명세에서 대시보드(`/`)의 401 처리가 명시되지 않았으므로, 대시보드는 비로그인 사용자도 접근 가능한 랜딩 페이지로 활용한다. 보호된 페이지(`/task`, `/task/:id`, `/user`)는 명세에 따라 401 시 즉시 로그인 페이지로 리다이렉트한다.

| 케이스 | 시작 상태 | 트리거 | 예상 결과 |
|:-------|:----------|:-------|:----------|
| 대시보드 401 | 비로그인 | 대시보드 API 401 응답 | 로그인 유도 UI 표시 (리다이렉트 없음) |
| 보호된 페이지 401 | 비로그인 또는 토큰 만료 | `/task`, `/task/:id`, `/user` API 401 응답 | 로그인 페이지로 즉시 리다이렉트 |
| 로그인 후 복귀 | 보호된 페이지에서 401 발생 | 로그인 성공 | 원래 접근하려던 페이지로 리다이렉트 |

### 1.3 토큰 갱신 💡 선택 (구현 전략에 따라 선택)

> **Note**: 명세에 `/api/refresh` API는 정의되어 있으나, 프론트엔드의 자동 갱신 및 재시도 로직은 명시되어 있지 않습니다. 아래는 토큰 관리 전략에 따라 **선택적으로 구현 가능한** 흐름입니다.

| 케이스 | 시작 상태 | 트리거 | 예상 결과 |
|:-------|:----------|:-------|:----------|
| 토큰 갱신 시도 | AccessToken 만료 | RefreshToken으로 갱신 요청 | 새 토큰 발급 |
| 토큰 갱신 성공 후 재시도 | 갱신 성공 | 원래 요청 재시도 | 정상 응답 |
| 토큰 갱신 실패 | RefreshToken 만료/무효 | 갱신 요청 실패 (400) | 로그인 페이지로 리다이렉트 |

---

## 2. 네비게이션(GNB/LNB) 흐름

### 2.1 비로그인 사용자 ✅ 필수

> 💡 **설계 결정**: 비로그인 사용자는 대시보드(`/`)에 접근 가능하며, GNB가 표시된다. 대시보드에서 로그인 아이콘을 통해 로그인 페이지로 이동할 수 있다.

| 케이스 | 사용자 행동 | 예상 결과 |
|:-------|:------------|:----------|
| 대시보드 접근 | GNB에서 대시보드 아이콘 클릭 | 대시보드 페이지 표시 (401 시 로그인 유도 UI) |
| 할 일 접근 | GNB에서 할 일 아이콘 클릭 | 할 일 페이지 진입 → API 401 → 로그인 페이지로 즉시 리다이렉트 |
| 로그인 클릭 | 로그인 아이콘 클릭 | 로그인 페이지(/sign-in)로 이동 |

### 2.2 로그인 사용자 ✅ 필수

| 케이스 | 사용자 행동 | 예상 결과 |
|:-------|:------------|:----------|
| 대시보드 클릭 | GNB에서 대시보드 아이콘 클릭 | 대시보드 페이지(/) 이동 |
| 할 일 클릭 | GNB에서 할 일 아이콘 클릭 | 할 일 목록(/task) 이동 |
| 회원정보 클릭 | 회원정보 아이콘 클릭 | 회원정보 페이지 이동 |

### 2.3 아이콘 상태 분기 ✅ 필수

| 로그인 상태 | 표시 아이콘 | 클릭 시 이동 |
|:------------|:------------|:-------------|
| 로그인됨 | 회원정보 아이콘 | 회원정보 페이지 |
| 비로그인 | 로그인 아이콘 | 로그인 페이지 |

---

## 3. 대시보드 (/) 흐름

> 💡 **설계 결정**: 대시보드는 비로그인 사용자도 접근 가능한 랜딩 페이지 역할을 한다. 원본 명세에서 대시보드의 401 처리가 명시되지 않았으므로, 401 응답 시 리다이렉트 없이 로그인 유도 UI를 표시한다.

### 3.1 대시보드 조회 ✅ 필수 + 💡 설계 결정

| 케이스 | 시작 상태 | 트리거 | 예상 결과 |
|:-------|:----------|:-------|:----------|
| 정상 조회 | 로그인됨 | 페이지 진입 | numOfTask, numOfRestTask, numOfDoneTask 표시 |
| 비로그인 접근 | 비로그인 | 페이지 진입 → API 401 응답 | 로그인 유도 UI 표시 (리다이렉트 없음) |

### 3.2 대시보드 UX ⚠️ 선택 (Should Have)

| 케이스 | 시작 상태 | 트리거 | 예상 결과 |
|:-------|:----------|:-------|:----------|
| 로딩 상태 | 로그인됨 | API 호출 중 | 로딩 인디케이터 표시 |

---

## 4. 할 일 목록 (/task) 흐름

### 4.1 목록 조회 ✅ 필수

| 케이스 | 시작 상태 | 트리거 | 예상 결과 |
|:-------|:----------|:-------|:----------|
| 정상 조회 | 로그인됨 | 페이지 진입 | 카드 목록 표시 (title, memo) |
| 인증 실패 (401) | 비로그인 또는 토큰 만료 | 페이지 진입 → API 401 응답 | 로그인 페이지로 즉시 리다이렉트, 로그인 후 /task로 복귀 |
| 서버 에러 (400) | 로그인됨 | API 400 응답 | 에러 모달 표시 (errorMessage + 목록으로 리다이렉트 버튼) |

### 4.2 목록 UX ⚠️ 선택 (Should Have)

| 케이스 | 시작 상태 | 트리거 | 예상 결과 |
|:-------|:----------|:-------|:----------|
| 빈 목록 | 로그인됨 | 데이터 없음 | 빈 상태 UI 표시 |
| 로딩 상태 | 로그인됨 | API 호출 중 | 로딩 인디케이터 표시 |

### 4.3 가상 스크롤링 ✅ 필수

| 케이스 | 시작 상태 | 사용자 행동 | 예상 결과 |
|:-------|:----------|:------------|:----------|
| 스크롤 다운 | 목록 상단 | 아래로 스크롤 | 뷰포트 내/근접 아이템만 렌더링 |
| 스크롤 업 | 목록 하단 | 위로 스크롤 | 상단 아이템 재렌더링 |
| 빠른 스크롤 | 목록 조회 중 | 빠르게 스크롤 | 부드러운 렌더링 유지 |

### 4.4 무한 스크롤 ✅ 필수

| 케이스 | 시작 상태 | 트리거 | 예상 결과 |
|:-------|:----------|:-------|:----------|
| 다음 페이지 로드 | 1페이지 로드됨 | 스크롤 끝 도달 | page+1 API 호출, 데이터 추가 |
| 마지막 페이지 | 마지막 데이터 | 스크롤 끝 도달 | 추가 API 호출 없음 |

### 4.5 카드 상호작용 ✅ 필수

| 케이스 | 사용자 행동 | 예상 결과 |
|:-------|:------------|:----------|
| 카드 클릭 | 특정 할 일 카드 클릭 | /task/:id 상세 페이지로 이동 |

---

## 5. 할 일 상세 (/task/:id) 흐름

### 5.1 상세 조회 ✅ 필수

| 케이스 | 시작 상태 | 트리거 | 예상 결과 |
|:-------|:----------|:-------|:----------|
| 정상 조회 | 로그인됨 | 페이지 진입 | title, memo, registerDatetime 표시 |
| 존재하지 않는 ID (404) | 로그인됨 | 잘못된 ID 접근 → API 404 응답 | 적절한 Not Found 페이지 렌더링 |
| 인증 실패 (401) | 비로그인 또는 토큰 만료 | 페이지 진입 → API 401 응답 | 로그인 페이지로 즉시 리다이렉트, 로그인 후 해당 상세 페이지로 복귀 |

### 5.2 삭제 플로우 ✅ 필수

> **Note**: 명세에 DELETE API는 정의되어 있지 않습니다. 삭제는 UX 플로우 검증 목적이며, 실제 API 호출 여부는 구현 선택에 따릅니다.

| 케이스 | 시작 상태 | 사용자 행동 | 예상 결과 |
|:-------|:----------|:------------|:----------|
| 삭제 버튼 클릭 | 상세 조회 중 | 삭제 버튼 클릭 | 삭제 확인 모달 표시 (ID 입력 input 포함) |
| ID 미입력 | 모달 열림 | input 비움 | 제출 버튼 비활성화 (bg=disabled) |
| 잘못된 ID 입력 | 모달 열림 | 해당 ID와 다른 값 입력 | 제출 버튼 비활성화 (bg=disabled) |
| 올바른 ID 입력 | 모달 열림 | 해당 ID와 동일한 값 입력 | 제출 버튼 활성화 (bg=primary) |
| 삭제 처리 완료 | ID 일치 입력됨 | 제출 버튼 클릭 | /task 목록으로 리다이렉트 |
| 모달 닫기 | 모달 열림 | 모달 외부 클릭 또는 취소 | 모달 닫힘, 상세 페이지 유지 |

---

## 6. 회원정보 페이지 흐름

### 6.1 회원정보 조회 ✅ 필수

| 케이스 | 시작 상태 | 트리거 | 예상 결과 |
|:-------|:----------|:-------|:----------|
| 정상 조회 | 로그인됨 | 페이지 진입 | name, memo 표시 |
| 인증 실패 (401) | 비로그인 또는 토큰 만료 | 페이지 진입 → API 401 응답 | 로그인 페이지로 즉시 리다이렉트 |

### 6.2 로그아웃 💡 선택 (Could Have)

> **Note**: 원본 명세에 로그아웃 API가 정의되어 있지 않습니다. UX 완성도를 위해 선택적으로 구현

| 케이스 | 시작 상태 | 사용자 행동 | 예상 결과 |
|:-------|:----------|:------------|:----------|
| 로그아웃 클릭 | 회원정보 페이지 | 로그아웃 버튼 클릭 | 토큰 제거 → `/sign-in` 리다이렉트 |

---

## 7. 에지 케이스 및 예외 흐름

### 7.1 네트워크 관련 ⚠️ 선택 (UX 보완)


| 케이스 | 상황 | 예상 결과 |
|:-------|:-----|:----------|
| 네트워크 끊김 | API 호출 중 오프라인 | 에러 처리 및 사용자 알림 |
| 느린 네트워크 | API 응답 지연 | 로딩 상태 표시 |
| 요청 타임아웃 | 응답 없음 | 타임아웃 에러 처리 |

### 7.2 브라우저 관련 ⚠️ 선택 (UX 보완)

| 케이스 | 상황 | 예상 결과 |
|:-------|:-----|:----------|
| 새로고침 | 페이지 새로고침 | 토큰 유지 시 상태 복원 |
| 뒤로가기 | 브라우저 뒤로가기 | 이전 페이지로 정상 이동 |
| 직접 URL 접근 | /task/123 직접 입력 | 인증 상태에 따라 처리 |

### 7.3 동시성 ⚠️ 선택 (UX 보완)

| 케이스 | 상황 | 예상 결과 |
|:-------|:-----|:----------|
| 중복 클릭 방지 | 제출 버튼 빠른 연타 | 단일 요청만 처리 |
| 무한 스크롤 로딩 중 중복 방지 | 다음 페이지 로딩 중 스크롤 끝 재도달 | 중복 API 호출 방지 |

### 7.4 여러 탭 동기화 💡 선택 (선택 구현)

| 케이스 | 상황 | 예상 결과 |
|:-------|:-----|:----------|
| 여러 탭 로그인 상태 | 탭 A에서 로그아웃 | 탭 B 새로고침 시 로그인 상태 반영 |

---

## 8. 흐름 다이어그램

### 8.1 비로그인 사용자의 페이지 접근 💡 설계 결정

> 대시보드는 랜딩 페이지로 비로그인 접근 허용, 보호된 페이지는 즉시 리다이렉트

```
┌─────────────────────────────────────────────────────────────────┐
│                                                                 │
│  시작: 비로그인 사용자                                          │
│    │                                                            │
│    ▼                                                            │
│  페이지 접근 시도                                               │
│    │                                                            │
│    ├─────────────────────────────────────┐                      │
│    │                                     │                      │
│    ▼                                     ▼                      │
│  대시보드 (/)                      보호된 페이지                │
│    │                               (/task, /task/:id, /user)    │
│    │                                     │                      │
│    ▼                                     ▼                      │
│  API 호출 → 401 응답               API 호출 → 401 응답          │
│    │                                     │                      │
│    ▼                                     ▼                      │
│  로그인 유도 UI 표시               경로 저장 후                 │
│  (리다이렉트 없음)                 /sign-in 즉시 리다이렉트     │
│    │                                     │                      │
│    ▼                                     ▼                      │
│  사용자가 로그인 클릭              로그인 성공                  │
│    │                                     │                      │
│    ▼                                     ▼                      │
│  /sign-in 이동                     저장된 경로로 리다이렉트     │
│                                                                 │
└─────────────────────────────────────────────────────────────────┘
```

### 8.2 할 일 삭제 흐름 ✅ 필수

```
┌─────────────────────────────────────────────────────────────────┐
│                                                                 │
│  /task/:id 조회                                                 │
│    │                                                            │
│    ▼                                                            │
│  삭제 버튼 클릭                                                 │
│    │                                                            │
│    ▼                                                            │
│  삭제 확인 모달 표시 (ID 입력 input 포함)                       │
│    │                                                            │
│    ▼                                                            │
│  ID 입력                                                        │
│    │                                                            │
│    ├──────────────────────┐                                     │
│    │                      │                                     │
│    ▼                      ▼                                     │
│  ID 불일치             ID 일치                                  │
│    │                      │                                     │
│    ▼                      ▼                                     │
│  제출 버튼 비활성화    제출 버튼 활성화                         │
│  (bg=disabled)         (bg=primary)                             │
│    │                      │                                     │
│    │                      ▼                                     │
│    │                   클릭                                     │
│    │                      │                                     │
│    │                      ▼                                     │
│    │                   삭제 처리 완료                           │
│    │                      │                                     │
│    │                      ▼                                     │
│    │                   /task로 리다이렉트                       │
│    │                                                            │
│    └──────► (재입력 대기)                                       │
│                                                                 │
└─────────────────────────────────────────────────────────────────┘
```

### 8.3 토큰 갱신 흐름 💡 선택 (선택적 구현)

> **Note**: 토큰 관리 전략에 따라 선택적으로 구현 가능한 흐름입니다.

```
┌─────────────────────────────────────────────────────────────────┐
│                                                                 │
│  API 요청                                                       │
│    │                                                            │
│    ▼                                                            │
│  401 응답 (AccessToken 만료)                                    │
│    │                                                            │
│    ▼                                                            │
│  RefreshToken으로 갱신 요청 (/api/refresh)                      │
│    │                                                            │
│    ├──────────────────────┐                                     │
│    │                      │                                     │
│    ▼                      ▼                                     │
│  갱신 성공 (200)       갱신 실패 (400)                          │
│    │                      │                                     │
│    ▼                      ▼                                     │
│  새 토큰 저장          로그인 페이지로                          │
│    │                   리다이렉트                               │
│    ▼                                                            │
│  원래 요청 재시도                                               │
│                                                                 │
└─────────────────────────────────────────────────────────────────┘
```

### 8.4 로그인 폼 유효성 검증 흐름 ✅ 필수

```
┌─────────────────────────────────────────────────────────────────┐
│                                                                 │
│  /sign-in 페이지 진입                                           │
│    │                                                            │
│    ▼                                                            │
│  폼 입력 (이메일, 비밀번호)                                     │
│    │                                                            │
│    ▼                                                            │
│  유효성 검증                                                    │
│    │                                                            │
│    ├─────────────────────────────────────┐                      │
│    │                                     │                      │
│    ▼                                     ▼                      │
│  검증 실패                            검증 성공                 │
│    │                                     │                      │
│    ├── 이메일 형식 오류                  │                      │
│    ├── 비밀번호 8자 미만                 │                      │
│    ├── 비밀번호 24자 초과                │                      │
│    ├── 비밀번호 문자 규칙 위반           │                      │
│    │                                     │                      │
│    ▼                                     ▼                      │
│  에러 메시지 표시                     제출 버튼 활성화          │
│  제출 버튼 비활성화                   (bg=primary)              │
│  (bg=disabled)                           │                      │
│    │                                     ▼                      │
│    │                                  제출                      │
│    │                                     │                      │
│    │                    ┌────────────────┴────────────────┐     │
│    │                    │                                 │     │
│    │                    ▼                                 ▼     │
│    │                 200 성공                         400 실패  │
│    │                    │                                 │     │
│    │                    ▼                                 ▼     │
│    │                 토큰 저장                      에러 모달   │
│    │                 대시보드 이동                  (errorMessage)
│    │                                                            │
│    └──────► (재입력 대기)                                       │
│                                                                 │
└─────────────────────────────────────────────────────────────────┘
```

---

## 9. 테스트 체크리스트

### 9.1 인증 ✅ 필수

- [ ] 유효한 이메일/비밀번호로 로그인 성공
- [ ] 잘못된 이메일 형식 시 에러 메시지 표시
- [ ] 비밀번호 8자 미만 시 에러 메시지 표시
- [ ] 비밀번호 24자 초과 시 에러 메시지 표시
- [ ] 비밀번호 영문/한글/숫자 외 문자 시 에러 메시지 표시
- [ ] 필수값 미입력 시 제출 버튼 비활성화
- [ ] 유효성 통과 시 제출 버튼 활성화 (bg=primary)
- [ ] 유효성 미통과 시 제출 버튼 비활성화 (bg=disabled)
- [ ] 로그인 폼에 명시적인 label 표시
- [ ] 서버 에러 (400) 시 에러 모달 표시
- [ ] 보호된 페이지에서 401 응답 시 로그인 페이지로 즉시 리다이렉트
- [ ] 로그인 후 원래 접근하려던 페이지로 복귀
- [ ] **이미 로그인된 상태에서 /sign-in 접근 시 대시보드로 리다이렉트**

### 9.2 네비게이션 ✅ 필수

- [ ] 비로그인 시 로그인 아이콘 표시
- [ ] 로그인 시 회원정보 아이콘 표시
- [ ] 각 메뉴별 아이콘이 겹치지 않음
- [ ] 대시보드 아이콘 클릭 시 대시보드 페이지로 이동
- [ ] 할 일 아이콘 클릭 시 할 일 페이지로 이동
- [ ] 로그인/회원정보 아이콘 클릭 시 해당 페이지로 이동

### 9.3 대시보드 ✅ 필수 + 💡 설계 결정

- [ ] 로그인 사용자: numOfTask (일의 개수) 정상 표시
- [ ] 로그인 사용자: numOfRestTask (해야할 일 개수) 정상 표시
- [ ] 로그인 사용자: numOfDoneTask (한 일의 개수) 정상 표시
- [ ] **비로그인 사용자: 대시보드 접근 가능 (랜딩 페이지)**
- [ ] **비로그인 사용자: 401 응답 시 로그인 유도 UI 표시 (리다이렉트 없음)**

### 9.4 대시보드 ⚠️ 선택

- [ ] 로딩 상태 표시

### 9.5 할 일 목록 ✅ 필수

- [ ] 카드 목록 정상 표시 (title, memo)
- [ ] 가상 스크롤링: 뷰포트 내/근접 요소만 렌더링
- [ ] 무한 스크롤: 목록 끝 도달 시 다음 페이지 API 호출
- [ ] 카드 클릭 시 상세 페이지(/task/:id) 이동
- [ ] 400 에러 시 에러 모달 표시 (errorMessage + 목록 리다이렉트 버튼)
- [ ] 401 에러 시 로그인 페이지로 즉시 리다이렉트 후 복귀

### 9.6 할 일 목록 ⚠️ 선택

- [ ] 빈 목록 상태 UI 표시
- [ ] 로딩 상태 표시

### 9.7 할 일 상세 ✅ 필수

- [ ] title, memo, registerDatetime 정상 표시
- [ ] 404 에러 시 적절한 Not Found 페이지 표시
- [ ] 401 에러 시 로그인 페이지로 즉시 리다이렉트 후 해당 상세 페이지로 복귀
- [ ] 삭제 버튼 제공
- [ ] 삭제 버튼 클릭 시 ID 입력 모달 표시
- [ ] ID 미입력/불일치 시 제출 버튼 비활성화 (bg=disabled)
- [ ] ID 일치 시 제출 버튼 활성화 (bg=primary)
- [ ] 삭제 처리 완료 시 /task 목록으로 리다이렉트

### 9.8 회원정보 ✅ 필수

- [ ] name 정상 표시
- [ ] memo 정상 표시
- [ ] 401 에러 시 로그인 페이지로 즉시 리다이렉트

### 9.8.1 회원정보 💡 선택

- [ ] 로그아웃 버튼 클릭 시 토큰 제거 및 /sign-in 리다이렉트

### 9.9 디자인 시스템 ✅ 필수

- [ ] 색상 토큰: primary(blue), disabled(gray) 적용
- [ ] Pretendard 폰트 전체 적용

---
